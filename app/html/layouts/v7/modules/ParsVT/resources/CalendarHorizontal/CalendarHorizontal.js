/* ********************************************************************************
 * The content of this file is subject to the VTFarsi.ir Modules License("License");
 * You may not use this file except in compliance with the License
 * The Initial Developer of the Original Code is VTFarsi.ir
 * Portions created by VTFarsi.ir. are Copyright(C) VTFarsi Team
 * All Rights Reserved.
 * ****************************************************************************** */
jQuery.Class("Settings_CalendarHorizontal_Js",{},{ckEditorInstance:!1,getckEditorInstance:function(){return 0==this.ckEditorInstance&&(this.ckEditorInstance=new Vtiger_CkEditor_Js),this.ckEditorInstance},registerLoadCKEditorEvents:function(){var t=jQuery("#events_custom_title"),e=jQuery("#calendar_custom_title"),n=this.getckEditorInstance();n.loadCkEditor(t),n.loadCkEditor(e),this.registerFillCustomTitleEvent()},registerFillCustomTitleEvent:function(){$("[name=events_fields]").on("change",function(t){var e=CKEDITOR.instances.events_custom_title,n=jQuery(t.currentTarget).val();if("undefined"!=e)e.insertHtml(n);else if(jQuery('textarea[name="events_custom_title"]')){jQuery('textarea[name="events_custom_title"]').insertAtCaret(n)}}),$("[name=calendar_fields]").on("change",function(t){var e=CKEDITOR.instances.calendar_custom_title,n=jQuery(t.currentTarget).val();if("undefined"!=e)e.insertHtml(n);else if(jQuery('textarea[name="calendar_custom_title"]')){jQuery('textarea[name="calendar_custom_title"]').insertAtCaret(n)}})},registerEvents:function(){$("#calendar-horizontal-settings-edit-container").length&&this.registerLoadCKEditorEvents()}}),jQuery(document).ready(function(){(new Settings_CalendarHorizontal_Js).registerEvents(),Vtiger_Index_Js.getInstance().registerEvents()}),jQuery.fn.extend({insertAtCaret:function(t){return this.each(function(e){if(document.selection){this.focus();document.selection.createRange().text=t,this.focus()}else if(this.selectionStart||"0"==this.selectionStart){var n=this.selectionStart,s=this.selectionEnd,i=this.scrollTop;this.value=this.value.substring(0,n)+t+this.value.substring(s,this.value.length),this.focus(),this.selectionStart=n+t.length,this.selectionEnd=n+t.length,this.scrollTop=i}else this.value+=t,this.focus()})}});